<Profile>:
    BoxLayout:
        orientation: 'vertical'

        MDTopAppBar:
            title: "User info        "
            title_halign: 'center'
            pos_hint: {"top": 1}
            elevation: 0
            md_bg_color: 1, 0, 0, 1
            left_action_items: [['arrow-left', lambda x: root.go_back()]]

        ScrollView:
            MDBoxLayout:
                orientation: 'vertical'
                padding: dp(20)
                spacing: dp(20)
                adaptive_height: True

                MDCard:
                    orientation: 'vertical'
                    size_hint: None, None
                    size: dp(150), dp(180)
                    pos_hint: {"center_x": 0.5}
                    elevation: 4
                    radius: [75,]
                    FitImage:
                        id: profile_image
                        source: ""
                        size_hint: None, None
                        size: dp(130), dp(130)
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        radius: [75, 75, 75, 75]
                    MDIconButton:
                        icon: 'camera-plus'
                        size_hint: None, None
                        size: dp(24), dp(24)
                        pos_hint: {"center_x": 0.5, "y": 0.1}
                        on_release: root.choose_profile_picture()

                MDTextField:
                    id: username
                    hint_text: "   Username"
                    icon_right: "account"
                    mode: "rectangle"
                    pos_hint: {"center_x": 0.5}
                    size_hint_x: None
                    width: dp(280)
                    on_text: self.text_color_normal = [0, 0, 0, 1] if self.text else [0.5, 0.5, 0.5, 1]

                MDTextField:
                    id: email
                    hint_text: "   Email"
                    icon_right: "email"
                    mode: "rectangle"
                    pos_hint: {"center_x": 0.5}
                    size_hint_x: None
                    width: dp(280)
                    on_text: self.text_color_normal = [0, 0, 0, 1] if self.text else [0.5, 0.5, 0.5, 1]

                MDTextField:
                    id: phone
                    hint_text: "   Phone Number"
                    icon_right: "phone"
                    mode: "rectangle"
                    pos_hint: {"center_x": 0.5}
                    size_hint_x: None
                    width: dp(280)
                    on_text: self.text_color_normal = [0, 0, 0, 1] if self.text else [0.5, 0.5, 0.5, 1]

                MDTextField:
                    id: address
                    hint_text: "   Address"
                    icon_right: "map-marker"
                    mode: "rectangle"
                    pos_hint: {"center_x": 0.5}
                    size_hint_x: None
                    width: dp(280)
                    on_text: self.text_color_normal = [0, 0, 0, 1] if self.text else [0.5, 0.5, 0.5, 1]

                MDTextField:
                    id: city
                    hint_text: "   City"
                    icon_right: "city"
                    mode: "rectangle"
                    pos_hint: {"center_x": 0.5}
                    size_hint_x: None
                    width: dp(280)
                    on_text: self.text_color_normal = [0, 0, 0, 1] if self.text else [0.5, 0.5, 0.5, 1]

                MDTextField:
                    id: state
                    hint_text: "   State"
                    icon_right: "map"
                    mode: "rectangle"
                    pos_hint: {"center_x": 0.5}
                    size_hint_x: None
                    width: dp(280)
                    on_text: self.text_color_normal = [0, 0, 0, 1] if self.text else [0.5, 0.5, 0.5, 1]

                MDTextField:
                    id: country
                    hint_text: "   Country"
                    icon_right: "earth"
                    mode: "rectangle"
                    pos_hint: {"center_x": 0.5}
                    size_hint_x: None
                    width: dp(280)
                    on_text: self.text_color_normal = [0, 0, 0, 1] if self.text else [0.5, 0.5, 0.5, 1]

                MDTextField:
                    id: dob
                    hint_text: "   Date of Birth"
                    icon_right: "calendar"
                    mode: "rectangle"
                    pos_hint: {"center_x": 0.5}
                    size_hint_x: None
                    width: dp(280)
                    on_text: self.text_color_normal = [0, 0, 0, 1] if self.text else [0.5, 0.5, 0.5, 1]
                    on_focus: if self.focus: root.show_date_picker()

                MDRectangleFlatButton:
                    text: "Save"
                    pos_hint: {"center_x": 0.5}
                    size_hint: 0.3, None  # Adjust size hint for width
                    height: dp(40)  # Fixed height
                    width: dp(200)
                    text_color: 1, 0, 0, 1
                    line_color: 1, 0, 0, 1
                    on_release: root.save_data()
