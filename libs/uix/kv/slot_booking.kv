<TaskSchedulerScreen>:

    MDBoxLayout:
        orientation: 'vertical'
        MDBoxLayout:
            orientation: 'horizontal'
            size_hint_y: None
            height: dp(60)
            padding:dp(15),dp(0),dp(20),dp(0)
            MDIconButton:
                icon: "arrow-left"
                pos_hint: {"center_y": .5}
                user_font_size: "20sp"
                theme_text_color: "Custom"
                text_color: rgba(34, 34, 34, 255)
                on_release:root.back_screen()
                halign:'left'
            MDLabel:
                text: "Schedule Appointment"
                font_name: "Roboto-Bold"
                font_size: "20sp"
                #pos_hint: {"center_x": .56, "center_y": .94}
                color: rgba(34, 34, 34, 255)
                halign:'center'

        MDBoxLayout:
            orientation: 'vertical'
            size_hint_y: None
            height: dp(60)
            padding: dp(20),dp(20),dp(20),dp(0)
            spacing:dp(10)

            MDLabel:
                id: day_label
                text: ""
                font_style: "H4"
                # halign: "center"
                color:1,0,0,1

            MDLabel:
                id: date_label
                text: ""
                font_style: "Subtitle1"
                # halign: "center"
                color:1,0,0,1

        MDBoxLayout:
            size_hint_y: None
            height: dp(80)
            ScrollView:
                adaptive_width:True
                MDBoxLayout:
                    id: date_box
                    adaptive_width:True
                    orientation: 'horizontal'
                    size_hint_y: None
                    height: dp(80)
                    spacing: dp(10)
                    padding: dp(20), dp(0), dp(20), dp(0)
                    pos_hint_y:{'center_y':1}

        FloatLayout:
            MDScrollView:
                GridLayout:
                    cols:2
                    size_hint_y: None
                    height: dp(1230)  # Timeline height for 12 hours with each hour taking 50dp
                    padding: dp(10)

                    MDBoxLayout:
                        orientation: 'vertical'
                        size_hint_x: None
                        width: dp(120)

                        canvas.before:
                            Color:
                                rgba: 0.7, 0.7, 0.7, 1
                            Line:
                                points: [dp(25), self.top, dp(25), self.y]
                                width: 1.5

                        MDBoxLayout:
                            size_hint_y: None
                            height: dp(100)
                            padding:'25dp','0dp','0dp','0dp'

                            MDLabel:
                                text:'7:00 am'
                                pos_hint:{'center_y':1}

                        MDBoxLayout:
                            size_hint_y: None
                            height: dp(100)
                            padding:'25dp','0dp','0dp','0dp'
                            MDLabel:
                                text:'8:00 am'
                                pos_hint:{'center_y':1}

                        MDBoxLayout:
                            size_hint_y: None
                            height: dp(100)
                            padding:'25dp','0dp','0dp','0dp'
                            MDLabel:
                                text:'9:00 am'
                                pos_hint:{'center_y':1}

                        MDBoxLayout:
                            size_hint_y: None
                            height: dp(100)

                            padding:'25dp','0dp','0dp','0dp'
                            MDLabel:
                                text:'10:00 am'
                                pos_hint:{'center_y':1}

                        MDBoxLayout:
                            size_hint_y: None
                            height: dp(100)

                            padding:'25dp','0dp','0dp','0dp'
                            MDLabel:
                                text:'11:00 am'
                                pos_hint:{'center_y':1}

                        MDBoxLayout:
                            size_hint_y: None
                            height: dp(100)
                            padding:'25dp','0dp','0dp','0dp'
                            MDLabel:
                                text:'12:00 pm'
                                pos_hint:{'center_y':1}

                        MDBoxLayout:
                            size_hint_y: None
                            height: dp(100)
                            padding:'25dp','0dp','0dp','0dp'
                            MDLabel:
                                text:'1:00 pm'
                                pos_hint:{'center_y':1}

                        MDBoxLayout:
                            size_hint_y: None
                            height: dp(100)
                            padding:'25dp','0dp','0dp','0dp'
                            MDLabel:
                                text:'2:00 pm'
                                pos_hint:{'center_y':1}

                        MDBoxLayout:
                            size_hint_y: None
                            height: dp(100)
                            padding:'25dp','0dp','0dp','0dp'
                            MDLabel:
                                text:'3:00 pm'
                                pos_hint:{'center_y':1}

                        MDBoxLayout:
                            size_hint_y: None
                            height: dp(100)
                            padding:'25dp','0dp','0dp','0dp'
                            MDLabel:
                                text:'4:00 pm'
                                pos_hint:{'center_y':1}

                        MDBoxLayout:
                            size_hint_y: None
                            height: dp(100)
                            padding:'25dp','0dp','0dp','0dp'
                            MDLabel:
                                text:'5:00 pm'
                                pos_hint:{'center_y':1}

                        MDBoxLayout:
                            size_hint_y: None
                            height: dp(100)
                            padding:'25dp','0dp','0dp','0dp'
                            MDLabel:
                                text:'6:00 pm'
                                pos_hint:{'center_y':1}

                        MDBoxLayout:
                            size_hint_y: None
                            height: dp(0)
                            padding:'25dp','0dp','0dp','0dp'
                            MDLabel:
                                text:'7:00 pm'
                                pos_hint:{'center_y':1}

                    FloatLayout:
                        id: task_layout
                        size_hint_y: None
                        height: dp(1200)  # Match the height of the timeline
                        # padding: dp(10)
                        md_bg_color: 0.87, 0.96, 0.88, 1


            MDFloatingActionButton:
                icon: "plus"
                pos: self.parent.width - self.width - dp(16), dp(16)
                on_release: root.show_add_task_dialog()
                elevation_normal: 8

<TaskCard@MDCard>:
    size_hint: None, None
    width: dp(270)
    orientation: 'vertical'
    padding: dp(10)
    radius: [10,]
    on_start_time: root.update_position()
    on_end_time: root.update_position()
    MDGridLayout:
        cols:1
        pos_hint_y:{'top':1}
        MDLabel:
            text: f'{root.start_time}-{root.end_time}'
            theme_text_color: "Secondary"
            size_hint_y: None
            height: self.texture_size[1]

        MDLabel:
            text: root.title
            theme_text_color: "Primary"
            font_style: "H6"
            size_hint_y: None
            height: self.texture_size[1]

        MDLabel:
            text: root.description
            theme_text_color: "Secondary"
            size_hint_y: None
            font_size:'14sp'
            height: self.texture_size[1]


<AddTask>:
    orientation: 'vertical'
    size_hint_y: None
    height: dp(320)
    pos_hint:{'top':1}
    MDBoxLayout:
        orientation: 'vertical'
        pos_hint:{'top':1}
        MDTextField:
            id: selected_date
            readonly: True
            text:root.date
            hint_text: "Date"
            mode: "rectangle"
        MDTextField:
            id: task_title
            hint_text: "Task Title"
            mode: "rectangle"
        GridLayout:
            cols:2
            spacing: dp(10)
            size_hint_y:None
            height:start_time.height+ 10
            MDTextField:
                id: start_time
                hint_text: "Start Time "
                readonly: True
                mode: "rectangle"
                icon_right: "clock-time-nine-outline"
                on_focus:if self.focus:root.show_start_time_picker()

            MDTextField:
                id: end_time
                hint_text: "End Time "
                readonly: True
                mode: "rectangle"
                icon_right: "clock-time-nine-outline"
                on_focus:if self.focus:root.show_end_time_picker()
        MDTextField:
            id: task_description
            hint_text: "Task Description"
            mode: "rectangle"
            radius:[20,]
        MDBoxLayout:
            size_hint_y: None
            spacing:'10dp'
            padding:'5dp'
            MDRaisedButton:
                text: "CANCEL"
                on_release: root.task_dismiss()

            MDRaisedButton:
                text: "ADD"
                on_release: root.add_task()


